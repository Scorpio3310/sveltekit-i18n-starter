<script>
    // Imports
    import navigationData from "$lib/navigation-links";
    import { page } from "$app/state";
    import { isCurrentRoute } from "$lib/helpers";
    import { languages, switchLanguageUrl, translatePath } from "$i18n/i18n";
    import { t } from "$i18n/i18n";

    const _links = navigationData;
    const currentLocale = page.data.lang;
</script>

<header class="nav-header" role="banner">
    <!-- Mobile menu toggle (CSS only) -->
    <input
        type="checkbox"
        id="mobile-menu-toggle"
        class="mobile-menu-checkbox"
        aria-label="Toggle mobile menu"
    />

    <div class="flex items-center justify-between">
        <a href={translatePath("/")} aria-label="Home">
            <svg
                height="20"
                viewBox="0 0 348 81"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                aria-label="Logo"
                class="hover:opacity-50"
            >
                <path
                    d="M27.3552 80.2609C23.1602 80.2609 19.5497 79.6767 16.5238 78.5083C13.4979 77.3399 10.7127 75.8279 8.16813 73.9722L3.31979 78.9207H0.225098V57.2712H3.42294C4.24819 60.6389 5.58922 63.8004 7.44604 66.7557C9.37162 69.711 11.9505 72.1165 15.1828 73.9722C18.415 75.7591 22.3693 76.6526 27.0457 76.6526C30.8969 76.6526 34.0947 76.0341 36.6393 74.7969C39.2526 73.5598 41.2125 71.876 42.5192 69.7454C43.8946 67.5461 44.5823 65.1406 44.5823 62.5289C44.5823 59.8485 43.9634 57.6835 42.7255 56.0341C41.4876 54.3846 39.8715 53.1131 37.8771 52.2196C35.9516 51.2574 33.854 50.5014 31.5846 49.9516C29.3839 49.4018 27.2864 48.8863 25.2921 48.4052C20.4781 47.1681 16.2487 45.553 12.6039 43.5598C8.959 41.498 6.10501 38.8519 4.04188 35.6217C2.04753 32.3914 1.05035 28.3708 1.05035 23.5598C1.05035 18.2677 2.18507 13.9035 4.45451 10.467C6.72394 7.03062 9.71548 4.48767 13.4291 2.83818C17.1427 1.11997 21.0971 0.260864 25.2921 0.260864C28.3868 0.260864 31.1376 0.707598 33.5446 1.60107C36.0203 2.49454 38.6336 3.80038 41.3845 5.5186L45.4075 1.1887H48.6054V22.2196H45.5107C43.5164 15.6904 40.8343 11.0169 37.4645 8.199C34.0947 5.31241 29.9685 3.86911 25.0858 3.86911C22.1286 3.86911 19.4122 4.35021 16.9364 5.31241C14.5294 6.20588 12.6039 7.51172 11.1597 9.22993C9.71548 10.9481 8.99338 12.9756 8.99338 15.3124C8.99338 17.5117 9.61232 19.333 10.8502 20.7763C12.0881 22.1509 13.7042 23.2506 15.6985 24.0753C17.6929 24.9 19.8248 25.5873 22.0942 26.1372C24.3637 26.687 26.5299 27.2024 28.5931 27.6835C33.8197 28.9207 38.221 30.6389 41.7971 32.8382C45.3732 34.9688 48.0896 37.7866 49.9464 41.2918C51.8032 44.7969 52.7316 49.1956 52.7316 54.4877C52.7316 62.5976 50.531 68.9207 46.1296 73.4567C41.7971 77.9928 35.5389 80.2609 27.3552 80.2609Z"
                    fill="#111111"
                />
                <path
                    d="M77.8043 80.2609C73.678 80.2609 70.6521 79.5392 68.7265 78.0959C66.8697 76.5839 65.9413 74.4189 65.9413 71.6011V35.7248H57.5856V32.5289C60.1989 32.3227 62.6403 31.3949 64.9097 29.7454C67.2479 28.0959 69.3454 25.9653 71.2023 23.3536C73.1278 20.742 74.7096 17.8897 75.9475 14.7969H80.1769V32.5289H92.0398V35.7248H80.1769V69.8485C80.1769 72.9413 81.4835 74.4877 84.0968 74.4877C85.4722 74.4877 86.6757 74.0753 87.7073 73.2506C88.8076 72.3571 90.0111 70.8451 91.3177 68.7145L93.7935 70.1578C91.9367 73.9378 89.7704 76.5839 87.2946 78.0959C84.8189 79.5392 81.6554 80.2609 77.8043 80.2609Z"
                    fill="#111111"
                />
                <path
                    d="M114.101 80.1578C110.043 80.1578 106.708 79.0925 104.095 76.9619C101.481 74.8313 100.175 72.0134 100.175 68.5083C100.175 65.2093 101.344 62.3571 103.682 59.9516C106.089 57.5461 109.459 55.7248 113.791 54.4877C118.124 53.1818 123.179 52.5289 128.955 52.5289V40.467C128.955 38.6801 128.302 37.2712 126.995 36.2402C125.689 35.2093 123.969 34.6939 121.837 34.6939C120.049 34.6939 118.502 35.0375 117.195 35.7248C115.958 36.4121 115.339 37.3055 115.339 38.4052C115.339 39.2987 115.682 40.089 116.37 40.7763C117.127 41.3949 117.505 42.4258 117.505 43.8691C117.505 45.6561 116.783 47.2368 115.339 48.6114C113.963 49.986 112.278 50.6732 110.284 50.6732C108.29 50.6732 106.639 49.986 105.332 48.6114C104.026 47.2368 103.373 45.553 103.373 43.5598C103.373 41.2231 104.267 39.1268 106.055 37.2712C107.843 35.4155 110.318 33.9722 113.482 32.9413C116.645 31.8416 120.221 31.2918 124.21 31.2918C129.712 31.2918 134.251 32.2884 137.827 34.2815C141.403 36.2059 143.191 38.7488 143.191 41.9103V71.9104C143.191 72.5289 143.397 73.0787 143.81 73.5598C144.291 74.0409 144.876 74.2815 145.563 74.2815C146.114 74.2815 146.698 74.0409 147.317 73.5598C148.005 73.0787 148.933 72.1853 150.102 70.8794L152.165 73.2506C148.383 77.8554 144.085 80.1578 139.271 80.1578C136.451 80.1578 134.216 79.5049 132.566 78.199C130.984 76.8932 129.918 75.175 129.368 73.0444H128.955C127.717 74.8313 125.792 76.4808 123.179 77.9928C120.634 79.4361 117.608 80.1578 114.101 80.1578ZM121.012 74.4877C123.213 74.4877 125.07 73.5255 126.583 71.6011C128.164 69.6079 128.955 67.0306 128.955 63.8691V55.7248C124.554 55.7248 121.15 56.6526 118.743 58.5083C116.336 60.364 115.132 63.1131 115.132 66.7557C115.132 69.0925 115.614 70.9825 116.577 72.4258C117.608 73.8004 119.087 74.4877 121.012 74.4877Z"
                    fill="#111111"
                />
                <path
                    d="M153.714 78.9207V75.8279H162.07V35.6217H153.714V32.5289H176.306V40.467H176.718C178.988 36.6183 181.395 34.144 183.939 33.0444C186.484 31.876 188.753 31.2918 190.748 31.2918C193.911 31.2918 196.352 32.1165 198.072 33.766C199.791 35.3468 200.65 37.6492 200.65 40.6732C200.65 43.6286 199.894 45.7935 198.381 47.1681C196.937 48.5426 195.114 49.2299 192.914 49.2299C190.919 49.2299 189.097 48.6457 187.447 47.4774C185.865 46.309 185.074 44.5564 185.074 42.2196C185.074 40.8451 185.28 39.8485 185.693 39.2299C186.174 38.6114 186.415 38.1303 186.415 37.7866C186.415 37.6492 186.346 37.5461 186.209 37.4774C186.14 37.3399 185.934 37.2712 185.59 37.2712C184.489 37.2712 183.183 37.9928 181.67 39.4361C180.226 40.8794 178.953 42.7695 177.853 45.1062C176.821 47.443 176.306 49.986 176.306 52.7351V75.8279H183.011V78.9207H153.714Z"
                    fill="#111111"
                />
                <path
                    d="M227.603 80.2609C223.476 80.2609 220.45 79.5392 218.525 78.0959C216.668 76.5839 215.74 74.4189 215.74 71.6011V35.7248H207.384V32.5289C209.997 32.3227 212.439 31.3949 214.708 29.7454C217.046 28.0959 219.144 25.9653 221 23.3536C222.926 20.742 224.508 17.8897 225.746 14.7969H229.975V32.5289H241.838V35.7248H229.975V69.8485C229.975 72.9413 231.282 74.4877 233.895 74.4877C235.27 74.4877 236.474 74.0753 237.505 73.2506C238.606 72.3571 239.809 70.8451 241.116 68.7145L243.592 70.1578C241.735 73.9378 239.569 76.5839 237.093 78.0959C234.617 79.5392 231.454 80.2609 227.603 80.2609Z"
                    fill="#111111"
                />
                <path
                    d="M273.251 80.2609C269.675 80.2609 266.305 79.5736 263.141 78.199C260.047 76.8244 257.296 74.9688 254.889 72.632C252.551 70.2952 250.728 67.6492 249.422 64.6939C248.115 61.7385 247.462 58.6457 247.462 55.4155C247.462 51.4292 248.493 47.6148 250.556 43.9722C252.619 40.2609 255.542 37.2368 259.325 34.9C263.107 32.4945 267.543 31.2918 272.632 31.2918C276.758 31.2918 280.437 32.1165 283.67 33.766C286.971 35.4155 289.549 37.7866 291.406 40.8794C293.332 43.9035 294.295 47.5117 294.295 51.7042V52.8382H258.499V49.7454H279.75V43.4567C279.75 37.5461 277.274 34.5908 272.322 34.5908C270.19 34.5908 268.471 35.2437 267.165 36.5495C265.858 37.8554 264.895 40.089 264.276 43.2506C263.726 46.3433 263.451 50.6045 263.451 56.0341C263.451 61.6011 263.76 65.8966 264.379 68.9207C264.998 71.876 266.064 73.9035 267.577 75.0031C269.09 76.1028 271.153 76.6526 273.767 76.6526C277.411 76.6526 280.712 75.7591 283.67 73.9722C286.695 72.1853 289.206 69.0925 291.2 64.6939H294.604C293.16 69.4361 290.512 73.2162 286.661 76.0341C282.879 78.8519 278.409 80.2609 273.251 80.2609Z"
                    fill="#111111"
                />
                <path
                    d="M300.289 78.9207V75.8279H308.645V35.6217H300.289V32.5289H322.88V40.467H323.293C325.562 36.6183 327.969 34.144 330.514 33.0444C333.058 31.876 335.328 31.2918 337.322 31.2918C340.486 31.2918 342.927 32.1165 344.646 33.766C346.365 35.3468 347.225 37.6492 347.225 40.6732C347.225 43.6286 346.469 45.7935 344.956 47.1681C343.511 48.5426 341.689 49.2299 339.488 49.2299C337.494 49.2299 335.672 48.6457 334.021 47.4774C332.439 46.309 331.648 44.5564 331.648 42.2196C331.648 40.8451 331.855 39.8485 332.267 39.2299C332.749 38.6114 332.99 38.1303 332.99 37.7866C332.99 37.6492 332.921 37.5461 332.783 37.4774C332.714 37.3399 332.508 37.2712 332.164 37.2712C331.064 37.2712 329.757 37.9928 328.244 39.4361C326.8 40.8794 325.528 42.7695 324.428 45.1062C323.396 47.443 322.88 49.986 322.88 52.7351V75.8279H329.585V78.9207H300.289Z"
                    fill="#111111"
                />
            </svg>
        </a>

        <label for="mobile-menu-toggle" class="mobile-menu-toggle">
            <span></span>
            <span></span>
            <span></span>
        </label>
    </div>

    <nav class="nav-main" role="navigation" aria-label="Main navigation">
        <ul class="nav-list" role="menubar">
            {#each _links as { label, href, children }, i}
                {@const target = translatePath(href)}
                <li class="nav-item lg:relative" role="none">
                    <a
                        href={target}
                        class="nav-link block {isCurrentRoute(
                            target,
                            page.url?.pathname
                        )
                            ? 'text-blue-500'
                            : ''}"
                        role="menuitem"
                        aria-label={t(label)}
                    >
                        {t(label)}
                    </a>

                    {#if children && children.length > 0}
                        <ul
                            class="nav-dropdown"
                            role="menu"
                            aria-label={t(label)}
                        >
                            {#each children as { label: clabel, href: chref }}
                                {@const childTarget = translatePath(chref)}
                                <li role="none">
                                    <a
                                        href={childTarget}
                                        class="nav-dropdown-link {isCurrentRoute(
                                            childTarget,
                                            page.url?.pathname
                                        )
                                            ? 'text-blue-500'
                                            : ''}"
                                        role="menuitem"
                                        aria-label={t(clabel)}
                                    >
                                        {t(clabel)}
                                    </a>
                                </li>
                            {/each}
                        </ul>
                    {/if}
                </li>
            {/each}
        </ul>
        <div class="nav-actions">
            {#each languages as language}
                <div class="relative flex gap-x-2">
                    <a
                        class="hover:opacity-50 uppercase {language ===
                        currentLocale
                            ? 'text-blue-400'
                            : ''}"
                        href={switchLanguageUrl(
                            language,
                            `${page.url?.pathname}${page.url?.search}${page.url?.hash}`
                        )}
                        data-sveltekit-reload
                    >
                        <!-- {language_names[language].toUpperCase()} -->
                        {language}
                    </a>
                </div>
            {/each}
            <a
                href="https://github.com/Scorpio3310/sveltekit-i18n-starter"
                aria-label="GitHub SvelteKit i18n Starter"
                target="_blank"
                rel="noopener noreferrer"
                tabindex="0"
                class="hover:opacity-50"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="28"
                    height="28"
                    viewBox="0 0 16 16"
                    aria-hidden="true"
                    focusable="false"
                >
                    <path
                        fill="currentColor"
                        d="M8 0c4.42 0 8 3.58 8 8a8.01 8.01 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38c0-.27.01-1.13.01-2.2c0-.75-.25-1.23-.54-1.48c1.78-.2 3.65-.88 3.65-3.95c0-.88-.31-1.59-.82-2.15c.08-.2.36-1.02-.08-2.12c0 0-.67-.22-2.2.82c-.64-.18-1.32-.27-2-.27s-1.36.09-2 .27c-1.53-1.03-2.2-.82-2.2-.82c-.44 1.1-.16 1.92-.08 2.12c-.51.56-.82 1.28-.82 2.15c0 3.06 1.86 3.75 3.64 3.95c-.23.2-.44.55-.51 1.07c-.46.21-1.61.55-2.33-.66c-.15-.24-.6-.83-1.23-.82c-.67.01-.27.38.01.53c.34.19.73.9.82 1.13c.16.45.68 1.31 2.69.94c0 .67.01 1.3.01 1.49c0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8"
                    ></path>
                </svg>
            </a>
        </div>
    </nav>
</header>
